addpath ../data;

IC1_signature = {'DBF4','PAX6','NCAPD2','ANLN','TACC3','DEPDC1','HMGB3','DEPDC1B','SPDL1','TDP1','POLQ','MPHOSPH9','TMEM48','ASPM','PRR11','TRIP13','HMMR','NDE1','GTSE1','SPAG5','UBE2T','KIF22','NDC80','AURKA','TPX2','BIRC5','KIF4A','G2E3','CENPM','RANGAP1','CDKN3','KIAA0586','CEP128','EMC9','MYBL2','CDC25B','FAM83D','CENPI','CEP152','OIP5','ASF1B','H2AFV','NEIL3','WHSC1','NCAPG','CCDC34','FOXM1','RAD51AP1','TIMELESS','CDCA3','TTK','BRD8','KIF20A','SMC4','CEP70','ECT2','CENPA','TTF2','CDC20','DARS2','NEK2','CENPF','KIF14','CNTRL','PHF19','GOT1','CENPL','MASTL','CCDC77','TMPO','NCAPH','MND1','KIF18A','GPSM2','CCDC18','ZWINT','CIT','DDX39A','CENPK','STIL','HJURP','CKS2','DLGAP5','C15orf23','FAM64A','MIS18BP1','SGOL1','TOP2A','RFC3','CCNB1','PSRC1','CDCA8','TROAP','ESPL1','CKAP2','BORA','ODF2','SMC2','CDK5RAP2','ARHGEF39','GGH','NUSAP1','KIF23','CASC5','CENPO','KIF11','CEP55','KIF20B','CENPE','TMEM19','GAS2L3','BRCA2','DIAPH3','PIF1','FANCI','PLK4','KIF2C','NUF2','ANP32E','CCDC150','FANCD2','CCNA2','CDCA5','NCAPG2','MKI67','INCENP','SCLT1','NCAPD3','MLF1IP','SPC25','BUB3','SKA1','FAM122B','ATAD2','BUB1B','CCNB2','CDC25C','RACGAP1','SPC24','CCNF','NUP35','KIAA1524','SGOL2','KIF15','H2AFZ','POC1A','HMGB2','MAD2L1','CEP44','PTTG1','RAD21','MELK','SKA3','C11orf82','CENPN','FAM111A','KIAA0101','C18orf54','PLK1','TMEM194A','RRM1','TUBA1C','TK1','PBK','DTYMK','CKAP2L','BUB1','CDK1','ARL6IP1','SHCBP1','ESCO2','RHNO1','RRM2','DCP2','CKS1B','RNF26','ZWILCH','UBE2C','CKAP5','TUBB6','TYMS','GEN1','AURKB','APOBEC3B','RTKN2','KPNA2','SKA2','TRAIP','IQGAP3','HIST1H1B','CDCA2','PARPBP','KIF18B','SAPCD2','ERCC6L','ARHGAP11B','TUBB4B','H2AFX','ZMYM1','BLM','HSD17B11','ARHGAP11A','HMGN2','PRC1','MZT1','FGFR1OP','ARHGAP19','FAM72D','DHFR','KIFC1','RP11-303E16.2','CTD-2510F5.4'};
IC2_signature = {'C1orf112','RECQL','PHTF2','GGCT','DBF4','E2F2','ANLN','BRCA1','UBR7','DDX11','POLA2','MRE11A','DERA','CENPQ','UHRF1','RFC2','RAD51','POLQ','SYNE2','PMS1','MCM10','RAD18','SMC1A','MCM2','EED','TIPIN','TIMM21','MCM6','UNG','UBE2T','POLD3','RBL1','HSPB11','ORC1','RAD54L','ALG6','ORC6','WDR76','PHGDH','CLSPN','CDC45','CDC6','MSH2','TMEM38B','FKBP5','CDC7','CENPM','HMGXB4','MCM5','FOXRED2','POLE2','MTHFD1','VRK1','GINS1','MYBL2','TTI1','RBBP8','POLA1','PRPS2','CENPI','CCP110','CEP152','MCM4','RNASEH2A','ASF1B','LIG1','CASP2','NUDT1','RPA3','EZH2','OGN','ERLIN1','RAD51C','TMEM97','NCAPG','RAD51AP1','RFC5','MDM1','NUP107','TIMELESS','FBXO5','MCM3','GMNN','SLC29A1','RAD1','NUP155','C3orf14','FANCL','MSH6','DHCR24','IVNS1ABP','TTF2','RPA2','CASP8AP2','DCLRE1B','ACYP1','FAM178A','HELLS','MASTL','EXOSC8','TMPO','MND1','ZWINT','CENPK','CDK2','STIL','HJURP','EXOSC9','CSE1L','DEK','NUP85','C20orf72','MCM8','OMD','YEATS4','HAT1','DUT','PARP2','DNMT1','GINS2','HAUS8','TUBG1','PSMC3IP','TOP2A','ENOSF1','RPA1','FIGNL1','PCNA','NASP','RFC3','ANKRD32','TRIM45','TMEM106C','DDB2','SLC43A3','USP37','BRIP1','SMC2','PRPF4','TCF19','NRM','GGH','CTDSPL2','NUSAP1','CENPO','KIF20B','DNA2','BARD1','MNS1','C4orf21','HADH','NEDD1','BRCA2','FANCI','MYO19','FN3KRP','PLK4','ITGB3BP','DTL','PARP1','CHAC2','SLC20A1','CDCA7','FANCD2','SKP2','PRIM2','PHIP','MMS22L','FAM54A','CDCA5','NCAPG2','GINS4','HAUS6','CEP78','NPAT','CCDC15','CHEK1','DSN1','HIRIP3','TEX30','NCAPD3','MLF1IP','CENPJ','FBXO4','HAUS1','PDLIM3','EME1','NUP205','DCK','WDYHV1','ATAD2','SASS6','MIS18A','DONSON','CHAF1B','PKNOX1','SRSF2','POLR3K','USP1','KIAA1524','TOPBP1','KIF15','RFC4','SLBP','H2AFZ','HMGB2','MAD2L1','CDCA7L','PSIP1','ZNF367','MELK','C11orf82','LRR1','HPRT1','E2F7','KIAA1731','CENPN','MCM7','FAM111A','KIAA0101','C18orf54','TMEM194A','RRM1','CHAF1A','C19orf48','TK1','PBK','RFWD3','FEN1','APEX2','STRA13','HNRNPF','FAM161A','CDK1','CDCA4','INSR','NETO2','SHCBP1','ESCO2','CTPS1','RRM2','MTBP','MBOAT1','ZNF738','EXO1','ZWILCH','CSRP2','CCNE2','ZNF519','CCDC14','RMI2','ATAD5','VSIG10','TYMS','SHMT1','POLE','TOP3A','ARL6IP6','KDELC2','RMI1','DCTPP1','FANCB','GINS3','GJC1','LIN9','NR2C2AP','HIST1H1B','KNTC1','ZNF93','FANCA','PLSCR1','FAM111B','ZNF107','XRCC2','HIST1H4C','BLM','MCMBP','PRIM1','SFI1','TFDP1','TMEM116','WDHD1','DAXX','C4orf46','NUP62','DNAJC9','TREX1','DDX12P','DHFR','HAUS5','SNHG1'};
IC10_signature = {'CD99','TMEM98','JARID2','AASS','IGF1','IKZF2','DAPK2','TNC','BARX2','ZIC2','ADRB1','LMO3','PTGER3','ALX4','CDK14','CTTNBP2','ACTN2','N4BP2','ITM2A','PKP1','CADPS2','CEACAM6','RCOR1','EFNB1','GLG1','CREM','H2AFY2','DNAL4','ATP11C','PCDH11X','FCGRT','DLX5','CAV2','CAV1','CPVL','TSPAN13','SPATA6L','CDC37L1','SH3PXD2A','EBF3','DNAJC12','CCND1','RNF141','SOX6','SH2B3','WASF1','FAM46A','MAN2A1','C7','HES1','FN1','ID2','EPHA4','OLFML3','KMO','PADI2','TXNIP','AKAP7','OLFM3','KDSR','YPEL5','KIAA1217','NPY','EGR2','ZC3H13','NCKAP1L','NMI','TNFAIP6','PARD6B','COL21A1','PCSK2','BCL11B','TSPAN8','TUBA4A','HOXD13','TRPM4','OLFM1','SYT4','TPTE2','GSTM1','SYT6','HOOK1','ANXA1','CAPRIN1','MYC','CPEB2','SLCO5A1','TGS1','FAM117B','GLCE','NDST4','DUSP6','WDFY2','SLAIN1','SORD','CDH11','IFITM3','RERE','HMCN1','RGL1','SCN1A','MARCH1','MYO10','BDP1','TENM2','DCDC2','PRSS35','NLGN4X','TMEM47','AK3','CER1','LRRC4C','FADS1','CDH8','DLG2','FLI1','KCNE4','UHMK1','LONRF1','APCDD1','DKK2','SLC26A2','GDF6','STEAP2','FZD1','KIT','ADAMTS4','CACHD1','EPB41','CSRP1','PRAC','JAK1','RAVER2','NTNG1','CLDN1','ATP1A1','ABHD6','NPY1R','NPY5R','STEAP1','ZNF704','CCDC171','OTUD1','FAM123A','KIAA1462','CACNB2','CYYR1','MFAP4','PRKCB','FAM111A','LOXHD1','RHOH','GFRA2','UGT3A2','FAM84B','GSTM4','ZEB2','LDB2','PCDH7','CHD3','FOS','DLGAP1','GSTA4','MLLT3','ADRA1D','ID4','SLFN11','MYEOV','GLRX','DAB1','SMARCC1','GPR64','NET1','FZD4','CALCB','HOXD8','JAKMIP2','SNX18','SLC17A8','ALX1','TSPYL5','PENK','PAPPA','LHFP','NELL2','ROBO2','FLRT2','RBM11','PBX1','IFITM1','IRS2','WWOX','TRDN','CCK','FNBP1','DCC','LIPI','IL1RAP','AKR1C3','FAT4','MMP1','DAPK1','ENPP1','FAM49A','SIRPA','PAX9','CES1','DCLRE1A','NPTXR','RP13-16H11.2','AC022311.1','RP13-16H11.1','AC073135.3','KIAA1456','RP11-6C14.1','RP11-1258F18.1','RP11-521M14.1','TRAV1-2','RP11-252A24.7','RP11-18I14.10'};
IC14_signature = {'TNC','SLC2A3','PFKP','TRAM1','TGFBR3','CYBRD1','P4HA2','CA12','LMAN1','ENO1','PLOD1','IGBP1','AARS','DHPS','HMGXB4','TPD52L2','PRPF6','RNMT','PLP2','PGK1','NDRG1','SLC39A14','BNIP3L','GYS1','GPI','BET1','NAMPT','HBP1','CAV1','EIF4H','CWC25','DHX40','CCDC47','LGALS3BP','CRYAB','GAPDH','TPI1','ENO2','SOD2','VEGFA','HARS2','LOX','ARRDC3','CRBN','FAM162A','PFKFB4','GBE1','EFEMP1','IGFBP5','KDM3A','ID2','DARS','EPAS1','RLF','SLC2A1','FOXO3','PCMT1','UFM1','NT5C3','P4HA1','PRDX4','AMD1','TREM1','NRN1','MT2A','INSIG2','CANX','AAMP','ATF4','DNAJB9','EGLN3','OLFM1','AKAP12','LGALS3','DNAJB1','SEC61G','KIAA0907','C20orf111','USPL1','CHI3L1','ATP13A3','BHLHE40','LDHA','YARS','HILPDA','GLUL','NUMA1','SYTL2','FAM13A','TDG','IQGAP1','WDR45L','SNRNP200','GOLGA4','MARCH6','PAM','FEM1C','RBAK','EGFR','NTRK2','POLE3','ADM','ALDOA','UBC','PDK1','SPARCL1','PLOD2','BUB3','SLC16A1','HK1','FBXO32','HK2','AK4','PDPN','DHRS3','AZI2','CCNL1','ANKRA2','SUN1','ABCA1','C10orf10','NUDT21','RRM1','ANGPTL4','SPRYD3','EFNA1','GUSB','KBTBD2','SCG2','ZNF622','TOMM20','ZNF266','BNIP3','FAM91A1','MAN1B1','ZNFX1-AS1','IMPDH2','ZFAND2A','TMEM45A','SHMT2','DDX41','ANKRD37','ZNF395','MT1X','EIF4EBP1','ARL4C','ZNF292','SULF2','ERO1L','HSPA1B','HSPA1A','C4orf47','VDAC1','TMEM167B','CCNL2','EGFR-AS1','SBDSP1','RP11-213H15.3'};

%% load signature file
signatureMap = containers.Map;
clear signatureMap;
signatureMap = containers.Map;
fid = fopen('ics_and_signatures.gmt');
tline = fgetl(fid);
while ischar(tline)
    parts = regexp(tline,'\t','split');
    parts1 = {};
    for i=1:length(parts)
        temp = regexp(char(parts(i)),'[','split');
        parts1(i) = temp(1);
    end
    signatureMap(char(parts(1))) = parts1(3:end-1);
    tline = fgetl(fid);
end
fclose(fid);

%%
 tab = importdata('ASP14_TS_u.txt');
 data = tab.data;
 gene_names = tab.textdata(2:end,1);
datan = data;

annot_table = importdata('ASP14_sample_annotation.txt');
annot_table = annot_table(2:end);
for i=1:size(annot_table,1)
    s = char(annot_table(i));
    annots{i} = regexp(s,'\t','split');
    sample_names(i) = annots{i}(1);
    
    colors = char(annots{i}(5));
    colors = colors(2:end);
    if(size(colors,2)==4)
        colors = strcat('00',colors);
    end
    colors = sprintf('%s%s%s',colors(5:6),colors(3:4),colors(1:2));
    color_vals{i} = hex2rgb(colors);
    s_day = char(annots{i}(4));
    s_day = s_day(2:end);
    if i<=383
        days(i) = str2num(s_day);
    else
        days(i) = -1;
    end
end



% normalize
 sm = sum(data);
 datan = data./repmat(sm,size(data,1),1)*10^6;

datan = log10(datan+1);

%% compute scores
vr = var(datan');
[~,p] = sort(vr,'descend');
mostvar_genenames = gene_names(p(1:2000));
irx_mostvar = find(ismember(gene_names,mostvar_genenames));
datan_reduced = datan(irx_mostvar,:);
mostvar_genenames = gene_names(irx_mostvar);

irx_IC1 = find(ismember(mostvar_genenames,IC1_signature));
%mostvar_genenames(irx_IC1)
IC1_score = mean(datan_reduced(irx_IC1,:));
irx_IC2 = find(ismember(mostvar_genenames,IC2_signature));
IC2_score = mean(datan_reduced(irx_IC2,:));
irx_IC10 = find(ismember(mostvar_genenames,IC10_signature));
IC10_score = mean(datan_reduced(irx_IC10,:));
irx_IC14 = find(ismember(mostvar_genenames,IC14_signature));
IC14_score = mean(datan_reduced(irx_IC14,:));

keys = signatureMap.keys;
scoreMap = containers.Map;
clear scoreMap;
scoreMap = containers.Map;
for i=1:length(keys)
    irx_score = find(ismember(mostvar_genenames,signatureMap(char(keys(i)))));
    scores = mean(datan_reduced(irx_score,:));
    scoreMap(char(keys(i))) = scores;
end

prolif_thresh = 1.2;
ind_prolif = find((IC1_score>prolif_thresh)|(IC2_score>prolif_thresh));


%% gene vs days
figure;
genename = 'CCNE2';
prof = datan(find(strcmp(gene_names,genename)),:);
for i=1:length(IC1_score)
    x = days(i)+rand()*0.5;
    plot(x,prof(i),'ko','MarkerFaceColor',color_vals{i},'MarkerSize',7); hold on;
    if length(find(ismember(ind_prolif,i)))>0
        plot(x,prof(i),'ro','MarkerSize',10);
    end
end
dint = [7 9 10 11 14 17 22];
for i=1:length(dint)
    smx(i) = dint(i);
    smy(i) = mean(prof(find(days==dint(i))));
end
plot(smx,smy,'r-','LineWidth',4);
xlabel('Days','FontSize',20); 
ylabel(genename,'FontSize',20);
set(gcf,'Color','w');
set(gca,'FontSize',16);
ylim([min(prof) max(prof)]);
xlim([6 23]);


%% IC10 vs a gene
figure;
gene = 'CCNE2';
prof = datan(find(strcmp(gene_names,gene)),:);
for i=1:length(IC1_score)
    plot(IC10_score(i),prof(i),'ko','MarkerFaceColor',color_vals{i}); hold on;
    if length(find(ismember(ind_prolif,i)))>0
        plot(IC10_score(i),prof(i),'ro','MarkerSize',10);
    end   
end
[IC10_score_intervals,prof_smoothed_IC10] = smooth1(IC10_score,prof,15);
plot(IC10_score_intervals,prof_smoothed_IC10,'r-','LineWidth',4);
xlabel('IC-EwS','FontSize',20); ylabel(gene,'FontSize',20);
set(gcf,'Color','w');

%% IC1 vs a gene
figure;
gene = 'CENPE';
prof = datan(find(strcmp(gene_names,gene)),:);
for i=1:length(IC1_score)
    plot(IC1_score(i),prof(i),'ko','MarkerFaceColor',color_vals{i}); hold on;
    if length(find(ismember(ind_prolif,i)))>0
        plot(IC1_score(i),prof(i),'ro','MarkerSize',10);
    end   
end
[IC1_score_intervals,prof_smoothed_IC1] = smooth1(IC1_score,prof,15);
plot(IC1_score_intervals,prof_smoothed_IC1,'r-','LineWidth',4);
xlabel('IC-G2/M','FontSize',20); ylabel(gene,'FontSize',20);
set(gcf,'Color','w');


%% IC10 vs IC1
figure;
for i=1:length(IC1_score)
    plot(IC10_score(i),IC2_score(i),'ko','MarkerFaceColor',color_vals{i}); hold on;
    %text(IC10_score(i)+0.015,IC1_score(i),sprintf('%i',days(i)),'Color','r');
    if length(find(ismember(ind_prolif,i)))>0
        plot(IC10_score(i),IC2_score(i),'ro','MarkerSize',10);
    end
end
% [IC10_score_intervals,IC1_score_smoothed_IC10] = smooth1(IC10_score,IC1_score,20);
% plot(IC10_score_intervals,IC1_score_smoothed_IC10,'r-','LineWidth',4);
xlabel('IC-EwS','FontSize',20); ylabel('IC-G1/S','FontSize',20);
set(gcf,'Color','w');


%% IC14 vs IC10
figure;
for i=1:length(IC1_score)
    plot(IC10_score(i),IC14_score(i),'ko','MarkerFaceColor',color_vals{i}); hold on;
    %text(IC10_score(i)+0.015,IC1_score(i),sprintf('%i',days(i)),'Color','r');
    if length(find(ismember(ind_prolif,i)))>0
        plot(IC10_score(i),IC14_score(i),'ro','MarkerSize',10);
    end
end
 [IC10_score_intervals,IC14_score_smoothed_IC10] = smooth1(IC10_score,IC14_score,20);
 plot(IC10_score_intervals,IC14_score_smoothed_IC10,'r-','LineWidth',4);
xlabel('IC-EwS','FontSize',20); ylabel('IC14+','FontSize',20);
set(gcf,'Color','w');


%% IC2 vs IC1
figure;
for i=1:length(IC1_score)
    plot(IC2_score(i),IC1_score(i),'ko','MarkerFaceColor',color_vals{i}); hold on;
    if length(find(ismember(ind_prolif,i)))>0
        plot(IC2_score(i),IC1_score(i),'ro','MarkerSize',10);
    end
end
xlabel('IC-G1/S','FontSize',20); ylabel('IC-G2/M','FontSize',20);
set(gcf,'Color','w');

%% PCA plot
figure;
[v,u,s] = pca(datan','NumComponents',4);
for i=1:length(IC1_score)
    plot(-u(i,1),u(i,2),'ko','MarkerFaceColor',color_vals{i}); hold on;
    if length(find(ismember(ind_prolif,i)))>0
        plot(-u(i,1),u(i,2),'ro','MarkerSize',10);
    end
end
% fid = fopen('ASP14_PCA.txt','w');
% fprintf(fid,'SAMPLE\tDAY\tPC1\tPC2\tPC3\tPC4\n');
% for i=1:length(IC1_score)
%     fprintf(fid,'%s\t%i\t%2.3f\t%2.3f\t%2.3f\t%2.3f\n',char(sample_names(i)),days(i),u(i,1),u(i,2),u(i,3),u(i,4));
% end
% close(fid);
xlabel(sprintf('PC1 (%2.0f%%)',s(1)/sum(s)*100),'FontSize',20); 
ylabel(sprintf('PC2 (%2.0f%%)',s(2)/sum(s)*100),'FontSize',20); 
set(gcf,'Color','w');

%% IC2 vs days
figure;
for i=1:length(IC2_score)
    x = days(i)+rand()*0.5;
    plot(x,IC2_score(i),'ko','MarkerFaceColor',color_vals{i},'MarkerSize',7); hold on;
    if length(find(ismember(ind_prolif,i)))>0
        plot(x,IC2_score(i),'ro','MarkerSize',10);
    end
end
dint = [7 9 10 11 14 17 22];
for i=1:length(dint)
    smx(i) = dint(i);
    smy(i) = mean(IC1_score(find(days==dint(i))));
end
plot(smx,smy,'r-','LineWidth',4);
xlabel('Days','FontSize',20); ylabel('IC-G1/S','FontSize',20);
set(gcf,'Color','w');
set(gca,'FontSize',16);
ylim([min(IC2_score) max(IC2_score)]);
xlim([6 23]);


%% IC14 vs days
figure;
for i=1:length(IC1_score)
    x = days(i)+rand()*0.5;
    plot(x,IC14_score(i),'ko','MarkerFaceColor',color_vals{i},'MarkerSize',7); hold on;
    if length(find(ismember(ind_prolif,i)))>0
        plot(x,IC14_score(i),'ro','MarkerSize',10);
    end
end
dint = [7 9 10 11 14 17 22];
for i=1:length(dint)
    smx(i) = dint(i);
    smy(i) = mean(IC14_score(find(days==dint(i))));
end
plot(smx,smy,'r-','LineWidth',4);
xlabel('Days','FontSize',20); ylabel('IC14+','FontSize',20);
set(gcf,'Color','w');
set(gca,'FontSize',16);
ylim([min(IC14_score) max(IC14_score)]);
xlim([6 23]);

%% Number of zeros per day

irx_IC1 = find(ismember(gene_names,IC1_signature));
IC1_zero_prof = datan(irx_IC1,:)==0;
IC1_prof = datan(irx_IC1,:);
irx_IC2 = find(ismember(gene_names,IC2_signature));
IC2_zero_prof = datan(irx_IC2,:)==0;
IC2_prof = datan(irx_IC2,:);
irx_IC10 = find(ismember(gene_names,IC10_signature));
IC10_zero_prof = datan(irx_IC10,:)==0;
IC10_prof = datan(irx_IC10,:);

dint = [7 9 10 11 14 17 22];
for i=1:length(dint)
    ind_day = find(days==dint(i));
    
    zero_day = IC1_zero_prof(:,ind_day);
    num_zeros = sum(sum(zero_day));
    freq_zeros(i,1) = num_zeros/length(ind_day)/size(IC1_zero_prof,1);
    mean_exp(i,1) = mean(mean(IC1_prof(:,ind_day)));
    
    zero_day = IC2_zero_prof(:,ind_day);
    num_zeros = sum(sum(zero_day));
    freq_zeros(i,2) = num_zeros/length(ind_day)/size(IC2_zero_prof,1);
    mean_exp(i,2) = mean(mean(IC2_prof(:,ind_day)));

    zero_day = IC10_zero_prof(:,ind_day);
    num_zeros = sum(sum(zero_day));
    freq_zeros(i,3) = num_zeros/length(ind_day)/size(IC10_zero_prof,1);
    mean_exp(i,3) = mean(mean(IC10_prof(:,ind_day)));

end
figure;
plot(dint,freq_zeros(:,1),'ro-'); hold on;
plot(dint,freq_zeros(:,2),'bo-'); hold on;
plot(dint,freq_zeros(:,3),'ko-'); hold on;
legend('IC-G2/M','IC-G1/S','IC-EwS');
set(gcf,'Color','w');
xlabel('Days','FontSize',20);
ylabel('Frequency of zeros','FontSize',20);
figure;
plot(dint,mean_exp(:,1),'ro-'); hold on;
plot(dint,mean_exp(:,2),'bo-'); hold on;
plot(dint,mean_exp(:,3),'ko-'); hold on;
legend('IC-G2/M','IC-G1/S','IC-EwS');
set(gcf,'Color','w');
xlabel('Days','FontSize',20);
ylabel('Mean expression','FontSize',20);

%%
figure;
hist(IC10_score,30); xlabel('IC-EwS','FontSize',20); set(gcf,'Color','w');
figure;
hist(IC1_score,30); xlabel('IC-EwS','FontSize',20); set(gcf,'Color','w');
